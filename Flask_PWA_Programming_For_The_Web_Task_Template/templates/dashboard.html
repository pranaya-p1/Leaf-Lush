{% extends 'layout.html' %}
{% block content %}

<section class="dashboard">

    <!-- Welcome Section -->
    <div class="welcome-box outlined-box">
        <h2 class="welcome-header">
            <img src="{{ profile_pic }}" alt="Profile" class="user-avatar">
            Welcome {{ username }}!
        </h2>

        <div class="user-info">
            <p><strong>Bio:</strong> {{ session.get('bio', 'Loves all things green and growing ðŸŒ¿') }}</p>
            <p><strong>Fun Fact:</strong> {{ session.get('fun_fact', 'Once grew a plant from a coffee bean â˜•') }}</p>
            <a href="{{ url_for('update_profile', username=username) }}" class="btn">Update Profile</a>
        </div>
    </div>

    <!-- Your Plants -->
    <div class="plants-section outlined-box">
        <h3>View your other plants:</h3>
        <div class="plant-gallery">
            <div class="add-plant-btn">+</div>
        </div>
    </div>

    <!-- Follow Recommendations -->
    <div class="follow-section outlined-box dark-bg">
        <h3>Follow Recommendations:</h3>
        <div class="follow-profiles extended-row">
            {% for user in recommended_users %}
            <div class="profile-card outlined-box">
                <img src="{{ user.image }}" alt="{{ user.name }}">
                <h4>{{ user.name }}</h4>
                <p>{{ user.username }}</p>
                <button class="btn">Follow</button>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Posts -->
    <div class="posts-section outlined-box">
        <h3>Your Posts:</h3>
        <div class="empty-posts extended-row">
            <p>No posts yet â€” start sharing your garden!</p>
            <a href="{{ url_for('add_post') }}" class="btn add-post-btn">+</a>
        </div>
    </div>

</section>

<!-- Popup for username/profile picture setup -->
<div id="setup-popup" class="popup-overlay" style="display: none;">
    <div class="popup-content">
        <h2>Welcome to Leaf & Lush!</h2>
        <p>Create your display name and upload a profile picture ðŸŒ¿</p>
        <form action="{{ url_for('save_profile') }}" method="POST" enctype="multipart/form-data">
            <input type="text" name="username" placeholder="Enter a username" required>
            <input type="file" name="profile_pic" accept="image/*" required>
            <button type="submit" class="btn">Save</button>
        </form>
    </div>
</div>

{% if show_popup %}
<script>
    document.getElementById("setup-popup").style.display = "flex";
</script>
{% endif %}

{% endblock %}
